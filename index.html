<!DOCTYPE html>
<html prefix="" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Fork all worries away">
<meta name="viewport" content="width=device-width">
<title>Forked</title>
<link href="assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="assets/css/code.css" rel="stylesheet" type="text/css">
<link href="assets/css/dark.css" rel="stylesheet" type="text/css">
<link href="assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Share+Tech+Mono" rel="stylesheet">
<link href="assets/css/custom.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://pspiagicw.github.io/">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/my-first-hackthon/" type="text/html">
</head>
<body class="hack dark">

<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
         
    <header id="header"><h1 id="brand"><a href="." title="Forked" rel="home">

        <span id="blog-title">Forked</span>
    </a></h1>

        

        
    <nav id="menu"><ul>
<li><a href="archive.html">Archive</a></li>
                <li><a href="categories/">Tags</a></li>
                <li><a href="rss.xml">RSS feed</a></li>

    

    
    
    </ul></nav></header><main id="content"><div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/my-first-hackthon/" class="u-url">My First Hackathon!</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                pspiagicw
            </span></p>
            <p class="dateline">
            <a href="posts/my-first-hackthon/" rel="bookmark">
            <time class="published dt-published" datetime="2021-06-04T22:39:18+05:30" itemprop="datePublished" title="2021-06-04 22:39">2021-06-04 22:39</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orga77ba34" class="outline-2">
<h2 id="orga77ba34">Sylvie</h2>
<div class="outline-text-2" id="text-orga77ba34">
<p>
My newest creation for my first Hackathon!
</p>
</div>

<div id="outline-container-org0e0b91c" class="outline-3">
<h3 id="org0e0b91c">Hack the Terminal</h3>
<div class="outline-text-3" id="text-org0e0b91c">
<p>
My first hackathon required me to build a terminal app.The <i>Terminal</i> word caught my attention and considering myself quite a command line maestro , decided to try it.
</p>

<p>
The hacktahon was organized by some website known as <i>DevPost</i> , I had never heard of it.That meant I needed to sign for one more website!
Anyway the organizer was quite good and provided with enough information and the given time was 48 hours.
</p>
</div>
</div>

<div id="outline-container-org9988e12" class="outline-3">
<h3 id="org9988e12">My Experience</h3>
<div class="outline-text-3" id="text-org9988e12">
<p>
I loved the part of creating my first hackathon project. For the first time I was not creating something because of personal reason , but some materialistic objective.
</p>

<p>
For the time part , I managed to write major portion of my app within the first 12 hours.The next 24 hours were for resolving bugs and adding some extra features.
One of the biggest bugs was confusing me till the end , but I was able to solve just in time.
</p>

<p>
The next 12 hours was allocated for creating the GitHub repo , uploading a video to Youtube and filling out the project info in the website.
</p>
</div>
</div>

<div id="outline-container-org29e6abb" class="outline-3">
<h3 id="org29e6abb">My App</h3>
<div class="outline-text-3" id="text-org29e6abb">
<p>
My app is quite a simple terminal application.It is just a Python file with 500 lines(Right Now!) , the details of the program will be covered by me in the next post.
</p>

<p>
It is available at  <a href="https://github.com/pspiagicw/sylvie.git">github</a>. The youtube video will be updated in the repo.
</p>
</div>
</div>

<div id="outline-container-org88c5840" class="outline-3">
<h3 id="org88c5840">Conclusion</h3>
<div class="outline-text-3" id="text-org88c5840">
<p>
I loved the experience and definately would love to do more of such hackathons , the only concern is that most hackthon promote some development platform , when I am instead interested in making unique apps without any limitation.
</p>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/so-many-outputs/" class="u-url">So many outputs!</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                pspiagicw
            </span></p>
            <p class="dateline">
            <a href="posts/so-many-outputs/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-24T18:14:36+05:30" itemprop="datePublished" title="2021-05-24 18:14">2021-05-24 18:14</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orgd39bea1" class="outline-2">
<h2 id="orgd39bea1">So Many Outputs!</h2>
<div class="outline-text-2" id="text-orgd39bea1">
</div>
<div id="outline-container-orge9740f4" class="outline-3">
<h3 id="orge9740f4">Outputs , Outputs , Outputs</h3>
<div class="outline-text-3" id="text-orge9740f4">
<p>
When anybody starts in Machine Learning , they focus on learning to make solid and reliable models.They learn everything there is to learn about creating accurate models.
</p>

<p>
But when the model predicts , nobody cares about the output (atleast in the Learning Phase) , as they only see the performance of the model.Today we are going to look at outputs , how to generate multiple ones , or even interdependent outputs!
</p>
</div>
</div>

<div id="outline-container-orgad2b9d4" class="outline-3">
<h3 id="orgad2b9d4">Multiple Outputs</h3>
<div class="outline-text-3" id="text-orgad2b9d4">
<p>
They are easy depending on the model choosen , if a flexible model like SGDRegressor is used , they inherently support multiple outputs. <b>But</b> models like SVM Regressor , Bayesian Classifier need external help , for MultiOutput data , we have to train multiple models , one for each output.
These model work indenpendently of each other and predict it's output , which is appended as single 2D array.
</p>

<p>
<b><i>Which is better?</i></b>
Well that depends , if the ouputs are inversely proportional or don't have any correlation , use multiple models approach else use models like SGD etc.
The reason being models like SGD use same weights for predicting both outputs , so if they are unrelated or inversely related the weights will not change , as both errors push the weights in their side , thus weights being in a <i>Tug of War</i>.
Keep in Mind there is a difference between Dependent and Correlated , Correlated means that one output follows the same trend as the other output( Both increase or both decrease etc) , but Dependent means , one output cannot be predicted accurately without using the other output.
Here one output might increase while other decreases , but the decreasing one depends on the increasing one.
</p>

<p>
SKlearn automatically does this if such models are used , but we can also explicitly do this using <code>sklearn.multioutput.MultiOutputRegressor()</code> which takes in one estimator(model) , this model can even be custom model.
</p>
</div>

<div id="outline-container-orgf31e4cb" class="outline-4">
<h4 id="orgf31e4cb">Here is an Example!</h4>
<div class="outline-text-4" id="text-orgf31e4cb">
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
</pre></div>

<p>
We are using <code>sklearn.datasets.make_regression()</code> which gives a dataset having 3 output/target variables. So MultiOutputRegressor trains 3 independent models.
</p>

<div class="highlight"><pre><span></span><span class="n">rawdata</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_regression</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">n_targets</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

<p>
The remaining code is pretty standard ML code . There is absolutely no difference in training and testing as sklearn automatically handles all the complexity of 3 outputs(Scoring of each output seperately , averaging the three seperate scores of the models) begind the scenes!
</p>

<div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">rawdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">rawdata</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="kn">from</span> <span class="nn">sklearn.multioutput</span> <span class="kn">import</span> <span class="n">MultiOutputRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MultiOutputRegressor</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">())</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">train_x</span> <span class="p">,</span> <span class="n">test_x</span> <span class="p">,</span>  <span class="n">train_y</span> <span class="p">,</span> <span class="n">test_y</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span><span class="n">test_y</span><span class="p">))</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgb4e75cb" class="outline-4">
<h4 id="orgb4e75cb">Model's supporting multioutput inherently</h4>
<div class="outline-text-4" id="text-orgb4e75cb">
<p>
These model do not require external help for multioutput classification/regression.The reason being their internal working , if you are curious try to research how they work.
</p>

<ul class="org-ul">
<li>K Neighbors Classifier/Regressor</li>
<li>Stochastic Gradient Descent Regressor/Classifier</li>
<li>Linear Regression (Least Squares / Closed Form Solution) , Ridge , LASSO .</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgf262fd0" class="outline-3">
<h3 id="orgf262fd0">Interdependent MultiOutput</h3>
<div class="outline-text-3" id="text-orgf262fd0">
<p>
Till now we were using multiple models that work independently of each other i.e one models output does not influence others. <b>But</b> sometimes one output may influence the other , in such cases we have to use Chain Models.
These models act like a chain . One model's output is given as input along with the origin input dataset to the second model , whose output is included along with seond model's input  as input to the third model and so on.
The important point being the reused output , each model's output is given as input to the next model , along with that model's input.
The order is decided by us. This model is very useful in filling missing data  , as one bad data column can be improved by one model , while the final model predicts the final output.
</p>

<p>
Here is how to create a Chain Model , specifically <code>sklearn.multioutput.RegressorChain()</code> which takes in a single estimator , along with the order of the outputs.
</p>

<div class="highlight"><pre><span></span><span class="c1"># .. Previous code (Mostly data preparation)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">RegressorChain</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">(),</span><span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="c1"># .. Later code (Mostly testing and training)</span>
</pre></div>

<p>
Here the order is 1 then 3 then 2 , which means the first model will predict the first column in the output matrix then second model will predict third column using previous data , and third model will predict second column using it's previous data.
</p>
</div>
</div>

<div id="outline-container-org433c445" class="outline-3">
<h3 id="org433c445">Next Time!</h3>
<div class="outline-text-3" id="text-org433c445">
<p>
Exploring the less travelled roads is a hard but fun exercise.
Hope you learnt something new today and are curious about Machine Learning.
</p>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/a-little-math-would-not-kill-you/" class="u-url">A little math would not kill you!</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                pspiagicw
            </span></p>
            <p class="dateline">
            <a href="posts/a-little-math-would-not-kill-you/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-20T21:44:36+05:30" itemprop="datePublished" title="2021-05-20 21:44">2021-05-20 21:44</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org9e5b516" class="outline-2">
<h2 id="org9e5b516">A little maths would not kill you</h2>
<div class="outline-text-2" id="text-org9e5b516">
<p>
Today we are going to make some of the models in Pure Python , without any external library used.
</p>

<p>
The two models are <i>K Nearest Neighbors</i> and <i>Stochastic Gradient Descent(SGD)</i>.SGD is a simple model that is used for regression.
</p>
</div>

<div id="outline-container-orgda62c88" class="outline-3">
<h3 id="orgda62c88">Neighbor Classifier from scratch</h3>
<div class="outline-text-3" id="text-orgda62c88">
<p>
KNN works by calculating euclidean distance between the current data point and existing data points.
It chooses the closes ones and decides the majority vote as predicted class.
</p>

<p>
We are using OOP in Python , so if you don't know much about OOP in Python you can look here.
</p>

<p>
First let's make a class
</p>
<div class="highlight"><pre><span></span><span class="c1"># Class Custom Neighbos</span>
<span class="k">class</span> <span class="nc">CustonNeighborsClassifier</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
<p>
We have to make a <code>__init__()</code> method which can contain hyperparameters(Parameters that change working of model).In case of KNN <code>K</code> (No of neighbors) is the hyperparameter.
</p>

<p>
As sklearn has default k of 5 , we too will keep it 5 by default.Sklearn calls <code>k</code> as <code>n_neighbors</code>.
</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomNeighborsClassifier</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
	<span class="c1"># No of close points to consider</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">n_neighbors</span>
</pre></div>


<p>
Next we need to implement fit method, which would take input and their classes.This would further just store them as class internal variables.
KNN does not do any calculation until you tell it to predict class of new data points.
</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomNeighborsClassifier</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n_neighbors</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">n_neighbors</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</pre></div>

<p>
Next we need to implement the predict method.This would return a predicted class , using the existing data.
</p>

<p>
For this method , we need to calculate the euclidean distance between the given point and all known points.
Then we need to look at the closes ones(Pick <b>k</b> closes ones).Then look at the majority between them and return predicted class.
We need to import <code>math</code> module for some mathematical calculations.We also need to implement a <code>dist()</code> method to calculate euclidean distance.
We also need <code>Counter</code> from <code>collections</code> module , for counting majority.
</p>

<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="k">class</span> <span class="nc">CustomNeighborsClassifier</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">neighbors</span> <span class="o">=</span> <span class="n">n_neighbors</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">x</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">def</span> <span class="nf">dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">given</span><span class="p">,</span><span class="n">actual</span><span class="p">):</span>
	<span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">for</span> <span class="n">given_element</span> <span class="p">,</span> <span class="n">actual_element</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">given</span><span class="p">,</span><span class="n">actual</span><span class="p">):</span>
	    <span class="n">distance</span> <span class="o">+=</span> <span class="p">(</span><span class="n">given_element</span> <span class="o">-</span> <span class="n">actual_element</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
	<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
	<span class="n">distance_lists</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">))</span> <span class="p">]</span>
	<span class="n">distance_lists</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
	<span class="n">nearest</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">distance_lists</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbors</span><span class="p">]]</span>
	<span class="n">counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">nearest</span><span class="p">)</span>
	<span class="n">majority</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="n">majority_number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">'-inf'</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
	    <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">majority_number</span><span class="p">:</span>
		<span class="n">majority</span> <span class="o">=</span> <span class="n">i</span>
		<span class="n">majority_number</span> <span class="o">=</span> <span class="n">j</span>
	<span class="k">return</span> <span class="n">majority</span>
</pre></div>

<p>
Implementing score method is very easy , as we simply have to compare our own predict method and actual answers and calculate accuracy
</p>


<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="k">class</span> <span class="nc">CustomNeighborsClassifier</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">neighbors</span> <span class="o">=</span> <span class="n">n_neighbors</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">x</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">def</span> <span class="nf">dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">given</span><span class="p">,</span><span class="n">actual</span><span class="p">):</span>
	<span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">for</span> <span class="n">given_element</span> <span class="p">,</span> <span class="n">actual_element</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">given</span><span class="p">,</span><span class="n">actual</span><span class="p">):</span>
	    <span class="n">distance</span> <span class="o">+=</span> <span class="p">(</span><span class="n">given_element</span> <span class="o">-</span> <span class="n">actual_element</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
	<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
	<span class="n">distance_lists</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">))</span> <span class="p">]</span>
	<span class="n">distance_lists</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
	<span class="n">nearest</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">distance_lists</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbors</span><span class="p">]]</span>
	<span class="n">counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">nearest</span><span class="p">)</span>
	<span class="n">majority</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="n">majority_number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">'-inf'</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
	    <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">majority_number</span><span class="p">:</span>
		<span class="n">majority</span> <span class="o">=</span> <span class="n">i</span>
		<span class="n">majority_number</span> <span class="o">=</span> <span class="n">j</span>
	<span class="k">return</span> <span class="n">majority</span>
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
	<span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
	<span class="c1"># predictions = [ self.predict(data) for data in x ]</span>
	<span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="n">label</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span><span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">]</span>
	<span class="n">correct</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">predictions</span> <span class="k">if</span> <span class="n">x</span> <span class="p">)</span>
	<span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">correct</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
</pre></div>


<p>
Here we are using the <code>iris</code> dataset to find our model's accuracy.Using our model is the same as using sklearn's models
<code>fit()</code> for trianing and <code>score()</code> for testing.
</p>

<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="k">class</span> <span class="nc">CustomNeighborsClassifier</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">neighbors</span> <span class="o">=</span> <span class="n">n_neighbors</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
	<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="p">,</span> <span class="s2">"Input and Output dims don't match"</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">x</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">def</span> <span class="nf">dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">given</span><span class="p">,</span><span class="n">actual</span><span class="p">):</span>
	<span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">given</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span> <span class="p">,</span> <span class="s2">"Dims of input and output differ"</span>
	<span class="k">for</span> <span class="n">given_element</span> <span class="p">,</span> <span class="n">actual_element</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">given</span><span class="p">,</span><span class="n">actual</span><span class="p">):</span>
	    <span class="n">distance</span> <span class="o">+=</span> <span class="p">(</span><span class="n">given_element</span> <span class="o">-</span> <span class="n">actual_element</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
	<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
	<span class="n">distance_lists</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span> <span class="p">]</span>
	<span class="n">distance_lists</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
	<span class="n">nearest</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">distance_lists</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbors</span><span class="p">]]</span>
	<span class="n">counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">nearest</span><span class="p">)</span>
	<span class="n">majority</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="n">majority_number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">'-inf'</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
	    <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">majority_number</span><span class="p">:</span>
		<span class="n">majority</span> <span class="o">=</span> <span class="n">i</span>
		<span class="n">majority_number</span> <span class="o">=</span> <span class="n">j</span>
	<span class="k">return</span> <span class="n">majority</span>
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
	<span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
	<span class="c1"># predictions = [ self.predict(data) for data in x ]</span>
	<span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="n">label</span> <span class="k">for</span> <span class="n">data</span><span class="p">,</span><span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">]</span>
	<span class="n">correct</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">predictions</span> <span class="k">if</span> <span class="n">x</span> <span class="p">)</span>
	<span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">correct</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">rawdata</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">rawdata</span><span class="p">[</span><span class="s1">'data'</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">rawdata</span><span class="p">[</span><span class="s1">'target'</span><span class="p">]</span>
    <span class="n">train_x</span> <span class="p">,</span> <span class="n">test_x</span> <span class="p">,</span> <span class="n">train_y</span> <span class="p">,</span> <span class="n">test_y</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">CustomNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">))</span>
<span class="n">main</span><span class="p">()</span>
</pre></div>


<p>
97%!! , our model performs very good at predicting.
</p>

<p>
Now that you have information about how KNN works on the inside , try to code this without looking at this blog , share your accuracy acheived.
</p>
</div>
</div>

<div id="outline-container-org23ef4e8" class="outline-3">
<h3 id="org23ef4e8">Regression from Scratch(SGD)</h3>
<div class="outline-text-3" id="text-org23ef4e8">
<p>
This SGD Regressor implementation , try to understand this code by researching on SGD .This is more for my personal reference than explanation.
</p>

<p>
The most important step is in the <code>fit()</code> method.
</p>

<p>
Refer to this article for more information on SGD.
</p>

<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_california_housing</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="k">class</span> <span class="nc">CustomSGD</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.0000001</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">coef_</span> <span class="o">=</span> <span class="p">[</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="p">]</span>
	<span class="k">for</span> <span class="n">data_point</span><span class="p">,</span><span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
	    <span class="n">prediction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">data_point</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
	    <span class="n">error</span> <span class="o">=</span> <span class="n">label</span> <span class="o">-</span> <span class="n">prediction</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">data_point</span><span class="p">,</span><span class="n">error</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lr</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
	<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span> <span class="p">,</span> <span class="s2">"Input dims don't match training dim"</span>
	<span class="n">prediction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">prediction</span>
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">given</span><span class="p">,</span><span class="n">actual</span><span class="p">):</span>
	<span class="n">total_error</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">for</span> <span class="n">given_element</span><span class="p">,</span><span class="n">actual_element</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">given</span><span class="p">,</span><span class="n">actual</span><span class="p">):</span>
	    <span class="n">error</span> <span class="o">=</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">given_element</span><span class="p">)</span> <span class="o">-</span> <span class="n">actual_element</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
	    <span class="n">total_error</span> <span class="o">+=</span> <span class="n">error</span>
	<span class="n">mse</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">total_error</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
	<span class="n">avg</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">given</span><span class="p">)</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">mse</span><span class="o">/</span><span class="n">avg</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">rawdata</span> <span class="o">=</span> <span class="n">fetch_california_housing</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">rawdata</span><span class="p">[</span><span class="s1">'data'</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">rawdata</span><span class="p">[</span><span class="s1">'target'</span><span class="p">]</span>
    <span class="n">train_x</span> <span class="p">,</span> <span class="n">test_x</span> <span class="p">,</span> <span class="n">train_y</span> <span class="p">,</span> <span class="n">test_y</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">CustomSGD</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">))</span>
<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/quick-and-dirty-machine-learning/" class="u-url">Quick and Dirty Machine Learning</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                pspiagicw
            </span></p>
            <p class="dateline">
            <a href="posts/quick-and-dirty-machine-learning/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-17T19:38:59+05:30" itemprop="datePublished" title="2021-05-17 19:38">2021-05-17 19:38</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orgbd1f0e0" class="outline-2">
<h2 id="orgbd1f0e0">Quick and Dirty Machine Learning.</h2>
<div class="outline-text-2" id="text-orgbd1f0e0">
<p>
Today we will look at 2 machine learning models,one with classification and one with regression.
</p>

<p>
Regression trains a model to predict continuous value.That means the value does not have any range,it does not have to be contained within a specific class.
</p>
</div>

<div id="outline-container-org03eb513" class="outline-3">
<h3 id="org03eb513">Nonmenclature</h3>
<div class="outline-text-3" id="text-org03eb513">
<p>
In Machine Learning , some words/terms mean very specific things.
Some of them used in this tutorial are:
</p>
<ul class="org-ul">
<li>X: Input Data</li>
<li>Y: Output Data</li>
</ul>
<p>
These terms are used very extensively while writing machine learning code.Make sure they don't confuse you when you see them, here or elsewhere.
</p>
</div>
</div>

<div id="outline-container-org08b0ab4" class="outline-3">
<h3 id="org08b0ab4">Train Test Split</h3>
<div class="outline-text-3" id="text-org08b0ab4">
<p>
Earlier we did testing with our training data.
But we should never test on training data.
</p>

<p>
Instead  we should divide data into training and testing data.
</p>

<p>
Sklearn provides <code>train_test_split()</code> method for exactly this task.It takes X , y , and <code>split_size</code> (Default 20%).
</p>
</div>
</div>

<div id="outline-container-org83ca9b7" class="outline-3">
<h3 id="org83ca9b7">First Model</h3>
<div class="outline-text-3" id="text-org83ca9b7">
<p>
Here we are using Iris dataset.It provides four inputs(Petal Length , Petal Width , Sepal Length , Sepal Width) and our task is to predict the type of plant it is.
The flower must be one of 'Iris-Sentosa' , 'Iris-Virginica' , 'Iris-Versicolor'.We transform classes numerically into 0 , 1 , 2.
</p>

<p>
Sckit-Learn provides a simple <code>load_iris()</code> method which provides the data  in a an dict form.
</p>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="n">rawdata</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span> 
<span class="n">x</span> <span class="o">=</span> <span class="n">rawdata</span><span class="p">[</span><span class="s1">'data'</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">rawdata</span><span class="p">[</span><span class="s1">'target'</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>

<pre class="example">
150
150
</pre>


<p>
Splitting the data into training and testing is as simple as calling the <code>train_test_split()</code> method with the respective X and y values.
</p>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">train_x</span> <span class="p">,</span> <span class="n">test_x</span> <span class="p">,</span> <span class="n">train_y</span> <span class="p">,</span> <span class="n">test_y</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_y</span><span class="p">))</span>
</pre></div>

<pre class="example">
112
112
</pre>


<p>
<i>Here we are!</i>
</p>

<p>
Model selection is one of the most important aspect of Machine Learning.
Here we are using a RandomForestClassifier.We will discuss this model's inner working later!.
</p>

<p>
Training is as easy as using <code>fit()</code> method on the model.
</p>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="p">)</span>
</pre></div>

<p>
Testing is done through the usual <code>score()</code> method.This method selects the appropriate metric (Accuracy in this case) and shows how the model performed.
</p>

<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span><span class="n">test_y</span><span class="p">))</span>
</pre></div>

<pre class="example">
0.9736842105263158
</pre>


<p>
97%! Not bad!
</p>
</div>
</div>

<div id="outline-container-org17f61d2" class="outline-3">
<h3 id="org17f61d2">Second Model</h3>
<div class="outline-text-3" id="text-org17f61d2">
<p>
Regression is the task of predicting a continous value , which means it has no restrictions while prediciting values.
</p>

<p>
We are using california housing prices as our dataset.This dataset contains housing information for the state of california(USA).
We can use multiple parameters(House Age , No of Rooms , Location/Latitude/Longitude , etc) for predicting house prices.
</p>

<p>
House Prices have only one social restriction , it should be positive(Hopefully our model never does it!).
Apart from that our model can predict any real number , ranging from a few hundreds to values in the million.
</p>

<p>
You can get <b>California Housing Prices</b> by using <code>fetch_california_housing()</code> method , provided by sklearn.
</p>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_california_housing</span>

<span class="n">rawdata</span> <span class="o">=</span> <span class="n">fetch_california_housing</span><span class="p">()</span>
</pre></div>

<p>
Again , data is returned as a <code>dict()</code>.
</p>

<div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">rawdata</span><span class="p">[</span><span class="s1">'data'</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">rawdata</span><span class="p">[</span><span class="s1">'target'</span><span class="p">]</span>
</pre></div>

<pre class="example">
[5.1 3.5 1.4 0.2]
</pre>


<p>
Splitting training and testing data.
</p>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">train_x</span> <span class="p">,</span> <span class="n">test_x</span> <span class="p">,</span> <span class="n">train_y</span> <span class="p">,</span> <span class="n">test_y</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

<p>
Creating a model.
In this case we are using <code>RandomForestRegressor</code> which provides very good results.
</p>


<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span><span class="n">train_y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_x</span><span class="p">,</span><span class="n">test_y</span><span class="p">))</span>
</pre></div>

<pre class="example">
0.9602251219512195
</pre>


<p>
<i>96%</i>!! , this was my personal best while trying multiple models.More accuracy can be achieved by more experienced folks.
Ways to improve include
</p>
<ul class="org-ul">
<li>Choosing strong model</li>
<li>Using More Data</li>
<li>Extensive Feature Engineeering</li>
</ul>
</div>
</div>


<div id="outline-container-org9ffdd40" class="outline-3">
<h3 id="org9ffdd40">Sayonara!</h3>
<div class="outline-text-3" id="text-org9ffdd40">
<p>
Well you can try more models or learn more about the models, we used.Anyway keep learning!!
</p>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/rough-guide-on-matplotlib/" class="u-url">Rough Guide on Matplotlib</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                pspiagicw
            </span></p>
            <p class="dateline">
            <a href="posts/rough-guide-on-matplotlib/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-17T19:29:30+05:30" itemprop="datePublished" title="2021-05-17 19:29">2021-05-17 19:29</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org957fc7a" class="outline-2">
<h2 id="org957fc7a">Rough Guide to Matplotlib</h2>
<div class="outline-text-2" id="text-org957fc7a">
<p>
Do you have the need to create graphs? Visualize highly numerical data , or just look at beautifully generated graphs and get turned on!
</p>

<p>
<b>Well like any other situation Python has you covered!</b>
</p>

<p>
Matplotlib provides easy and efficient way of creating graphs.It is a python module , so you need <code>pip</code> to install it. <code>Pip</code> is python's modular structure allowing , us to share our code with others.
More information here.
<code>pip</code> can install any module from PyPI , python's official module location , or as cool people call it repository.
To install use <code>pip install</code> command.
</p>

<div class="highlight"><pre><span></span><span class="c1"># Installing matploblib</span>
pip install --user matplotlib
</pre></div>

<p>
Now that matplotlib is installed. We have to import it in Python , <b>importing</b> in python is easy!
</p>

<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
</pre></div>

<p>
But we don't need to import matplotlib itself, <code>matplotlib.pyplot</code> provides most of the features we need. The rest of matplotlib can be used to create extremely complex graphs.
Pyplot is inspired from <i>MATLAB</i> . If you have used <i>MATLAB</i> before , it has the same API.
This guide only focuses on PyPlot API , for a more object-based approach , see matplotlib's documentation, or refer to this guide.
</p>
</div>
<div id="outline-container-org85c8ea3" class="outline-3">
<h3 id="org85c8ea3">Important Funcs</h3>
<div class="outline-text-3" id="text-org85c8ea3">
<p>
PyPlot provides some useful functions mainly <code>pyplot.show()</code> and <code>pyplot.savefig()</code>.
These provide functionality to show and save the graphs we create!.
Without these method, you can plot your graphs , but can never see them.
</p>

<p>
Plotting is when you call the particular method (More on that later!).These method configures the matplotlib backend with your graph ,
<code>pyplot.show()</code> simply shows the configured , graph.
When you try to configure more than one plot , both are shown in same graph.
</p>

<p>
To see already plotted graph , use <code>pyplot.show()</code> , but using it also clears the graph after showing it.
While using it in a REPL , keep in mind to plot the graph again , before calling <code>pyplot.show()</code>.
</p>
<div class="highlight"><pre><span></span><span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<p>
To save a already plotted graph , use <code>pyplot.savefig()</code> , it takes name and format of image as arguments , which allows you to save the graph.
For example
</p>

<div class="highlight"><pre><span></span><span class="c1"># Graph already plotted!</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'example-graph.png'</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">'png'</span><span class="p">)</span>
</pre></div>

<p>
One thing before moving to next section!
Most people alias <code>pyplot</code> to <code>plt</code> in Python. So if you see <code>plt</code> anywhere, don't worry it is the same thing.
To alias pyplot to plt
</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>

<div id="outline-container-org5e09c1a" class="outline-3">
<h3 id="org5e09c1a">Basic Plotting</h3>
<div class="outline-text-3" id="text-org5e09c1a">
<p>
For plotting basic lines , <code>plt.plot()</code> function is enough, it takes list of x and y coordinates as arguments.
</p>

<p>
Plotting points (3,2),(5,4) and (4,1).Keep in mind plot method connects all the dots with a line.
</p>

<div class="highlight"><pre><span></span><span class="n">x_coordinates</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">y_coordinates</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">2</span> <span class="p">,</span> <span class="mi">4</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="c1"># Points (3,2),(5,4),(4,1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_coordinates</span><span class="p">,</span><span class="n">y_coordinates</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<p>
The graph created is
</p>

<p>
<img src="images/simple-plot-matplotlib.png" alt="nil"></p>
</div>
</div>

<div id="outline-container-orgaced015" class="outline-3">
<h3 id="orgaced015">Simple Scattering</h3>
<div class="outline-text-3" id="text-orgaced015">
<p>
Scatter plot simply shows all the coordinates/points without connecting them with a line.
</p>

<p>
Scatter plot are very useful in showing actual points , without a line seperating them.
It also takes list of x and y coordinates as arguments.
</p>

<p>
Showing (2,6),(4,5),(1,8) and (3,6) on a graph is easy.
</p>

<div class="highlight"><pre><span></span><span class="n">x_coordinates</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">2</span> <span class="p">,</span> <span class="mi">4</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">3</span> <span class="p">]</span>
<span class="n">y_coordinates</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">6</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">8</span> <span class="p">,</span> <span class="mi">6</span> <span class="p">]</span>
<span class="c1"># Points (2,6) , (4,5) , (1,8) and (3,6)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_coordinates</span> <span class="p">,</span> <span class="n">y_coordinates</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<p>
The end result
</p>

<p>
<img src="images/scatter-plot-matplotlib.png" alt="nil"></p>
</div>
</div>

<div id="outline-container-org68d3291" class="outline-3">
<h3 id="org68d3291">Histograms</h3>
<div class="outline-text-3" id="text-org68d3291">
<p>
Histograms in matplotlib is as easy as just giving the list of values you want a histogram of.
</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span> <span class="p">])</span>
</pre></div>

<p>
<img src="images/simple-hist-matplotlib.png" alt="nil"></p>

<p>
It provides a good view of how the data is distributed , over the range.
</p>
</div>
</div>

<div id="outline-container-org89ec3b1" class="outline-3">
<h3 id="org89ec3b1">Showing Images.</h3>
<div class="outline-text-3" id="text-org89ec3b1">
<p>
One more useful function , I use most of the time , is <code>plt.imshow()</code> . When working with a lot of images  this can show your image , with extra info/special filters etc.
</p>

<p>
It takes a 2-D matrix or 3-D matrix as input , depending on channels of image , that is how many colors are recorded , in data.A single color is represented as intensity value.
It can vary from 1 to 255.
 No of channels/colors can vary between 1-3 colors, if only 1 channel , image is black and white.
If having all 3 colors , image is a normal color image.The colors are simply RGB(Red ,Green and Blue).
</p>

<p>
For example this is an handwritten 5 , from MNIST dataset(Coming in future posts!) , which is stored in a 2-D array.
</p>

<div class="highlight"><pre><span></span><span class="c1"># Usage of matplotlib.pyplot.imshow()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<p>
<img src="images/mnist-plot-matplotlib.png" alt="nil"></p>
</div>
</div>


<div id="outline-container-org4598f1c" class="outline-3">
<h3 id="org4598f1c">Aesthetics.</h3>
<div class="outline-text-3" id="text-org4598f1c">
<p>
Graphs being almost 100% visual feedback , you might need to add some bling to it.
Matplotlib supports everything a graph might have.Make sure to read it's documentation afterwards.
</p>

<p>
To add label to any plot/scatter , just add label argument.Label make it easy to spot , when multiple plots are present.
You can also add label to x-axis and y-axis using methods like <code>plt.xlabel()</code> and <code>plt.ylabel()</code>.
</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Speed'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Distance'</span><span class="p">)</span>
</pre></div>

<p>
You can also add <code>text</code> to the graph , using the <code>plt.text()</code> method.For using this , you have to provide a coordinate and the text to plot.
This text can be customized (Color , Border etc).
</p>

<p>
You can add title to your graphs using <code>plt.title()</code> method.
</p>

<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_coordinates</span><span class="p">,</span><span class="n">y_coordinates</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Group 1'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_coordinates</span><span class="p">,</span><span class="n">y_coordinates</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">'Point (</span><span class="si">{x}</span><span class="s1">,</span><span class="si">{y}</span><span class="s1">)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<p>
<img src="images/labels-matplotlib.png" alt="nil"></p>

<p>
To plot one graph over another , use the plot/scatter function without using <code>plt.show()</code> or <code>plt.savefig()</code> first.
</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">7</span><span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">7</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">'Line y=x'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">6</span> <span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span> <span class="p">]</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Group of people'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<p>
<img src="images/multiple-plot-matplotlib.png" alt="nil"></p>


<p>
To show a legend in the graph use the <code>plt.legend()</code> function .
</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">7</span><span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">7</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">'Line y=x'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">6</span> <span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span> <span class="p">]</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Group of people'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<p>
You can customize plotting style by , specifying parameters such as
</p>

<ul class="org-ul">
<li>LineStyle: Using <code>linestyle</code> parameter to customize the line-drawn.</li>
<li>LineWidth: Using <code>linewidth</code> parameter to increase thickness of the line.</li>
<li>Marker: Using <code>marker</code> parameter , this changes how actual points are shown in the graph.See here for all the marker codes.</li>
<li>Color: Using color parameter, this changes color of the line drawn, see here for all the color codes.</li>
</ul>
<p>
This graph uses linestyle of <code>--</code> and linewidth of 3.5 ,marker type of <code>+</code> and color green.
</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_coodinates</span><span class="p">,</span><span class="n">y_coordinates</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Line'</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">'+'</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">'g'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

<p>
<img src="images/ultimate-custom-matplotlib.png" alt="nil"></p>


<p>
You can also customize matplotlib itself, using <code>styles</code>.
By default matplotlib's style is boring,I am using dracula style for my graphs.You can change everything from fonts to background.
More info on matplotlib's documentation.If you want to learn to use matplotlib , you have to read it.
</p>

<p>
Anyway , here's how to use a default dark-style(included in matplotlib) , for installing more themes look at matplotlib's website.
</p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">'dark_background'</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-org8f8155d" class="outline-3">
<h3 id="org8f8155d">Bon Voyage!</h3>
<div class="outline-text-3" id="text-org8f8155d">
<p>
That's basic matplotlib for you.You should definately look at their documentation.
You can also look at the Object API for matplotlib. It is a little advanced , but is highly configurable.
</p>

<p>
With the required info, you can make basic graphs , with text. I personally use matplotlib to create graphs for my Physic's classes and ofcourse Data Visualization in ML.
</p>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/the-rise-of-the-machines/" class="u-url">The rise of the Machines</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                pspiagicw
            </span></p>
            <p class="dateline">
            <a href="posts/the-rise-of-the-machines/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-15T22:39:18+05:30" itemprop="datePublished" title="2021-05-15 22:39">2021-05-15 22:39</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org18ef3c9" class="outline-2">
<h2 id="org18ef3c9">The rise of the Machines</h2>
<div class="outline-text-2" id="text-org18ef3c9">
<p>
Last time we saw a simple model train and predict on some user data.
We decided we will keep the explanation for later.
</p>

<p>
I think the time has come.
</p>
</div>

<div id="outline-container-org2c35601" class="outline-3">
<h3 id="org2c35601">Data</h3>
<div class="outline-text-3" id="text-org2c35601">
<p>
The most important aspect of Machine Learning is <i>data</i> , without it we cannot perform any training or testing.
Before the information age , data was hard to come by.
Storage was very expensive , it was better used to store useful information , rather than log previous data.
</p>

<p>
Invention of cheap hard disks changed this.Data could be stored.
</p>

<p>
Now that every bit of information about our lives is being tracked (for good or bad?), data can be used to build models.
</p>

<p>
These models are nothing but complex mathematical formulas , these try to create a formula of the given data.
In other words they try to generalize pattern in the data.
</p>

<p>
You can also say , Machine Learning is learning our habits/behaviour/instincts into a mathematical formula .
The formula could predict our every move , making a deterministic universe, allowing to predict the future.
Becoming a level 5 civilization.
</p>

<p>
<i>Well That was too much!</i>
</p>

<p>
Basically making a formula that maps input to output is machine learning.
</p>

<p>
In our last example we are using <code>make_moons</code> dataset , it provides coordinates of two intersecting circles.
</p>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_moons</span>
<span class="c1"># Dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">make_moons</span><span class="p">()</span>
</pre></div>

<p>
This provides us with a tuple (coordinates , output).
</p>
<ul class="org-ul">
<li>Coordinates - This is list of x and y coordinates of points.</li>
<li>Output - This is list whether they intersect or not.</li>
</ul>
<p>
If you are wondering , what are we doing with our data.
We are trying to classify .
</p>

<p>
<i>Classification</i> - Task where we try to take input data and predict which class the said input lies in.Class refers to the multiple type an input can fall into.
It is just fancy words for saying , we give stuff , you learn to sort them.
</p>
</div>
</div>
<div id="outline-container-org922a3dd" class="outline-3">
<h3 id="org922a3dd">Model</h3>
<div class="outline-text-3" id="text-org922a3dd">
<p>
For classification there are lot of techniques , Logistic Regression , K Nearest Neighbors , DecisionTree etc.
We can go overpowered and use multiplayer perceptron model , or even an RNN.
</p>

<p>
The important part of Machine Learning is selecting the right model , not <i>too weak</i> , not <i>too strong</i>.
</p>

<p>
If <i>too weak</i> ,model might not be able to learn the relation at all.
</p>

<p>
If <i>too strong</i> ,model might use lot of computational power, or even worse overfit (get personal with the data).
</p>

<p>
<i>Both are not Good!</i>
</p>

<p>
For this exercise, K Nearest Neighbor is good enough. Simple and Strong.
</p>
</div>
</div>

<div id="outline-container-orgc2d9a9a" class="outline-3">
<h3 id="orgc2d9a9a">K Nearest Neighbors</h3>
<div class="outline-text-3" id="text-orgc2d9a9a">
<p>
KNN(K Nearest Neighbors) tries to predict it's class/type by seeing who is nearest while on a cartesian graph.
</p>

<p>
Take this graph for example
</p>

<p>
<img src="images/knn-example.png" alt="nil"></p>

<p>
This graph has two groups , one in blue and one in pink.
</p>

<p>
For predicting group for any new point , it plots it on the graph , sees which points are near , using distance formula for corresponding cartesian plane.
</p>

<p>
For 1-d cartesian plane , distance formula is dist = coordinate1 - coordinate2.
</p>

<p>
For 2-d cartesian plane , distance formula is dist = sqrt( ( x2 - x1)**2 + ( y2 - y1)**2 )
where x1 is x coordinate of first point.
</p>

<p>
If you need a little refresher see this.
</p>

<p>
Using this distance information , it can see which points are nearest , it chooses the k nearest points , here k is arbitary(our choice).
After choosing the points it sees what class/group do majority of them lie in.
As we need majority always , K is always choosed as an odd number , so that no matter how ambiguous(Confusing) the point might look like , there is always a majority.
</p>

<p>
Here we are creating a model, by default sklearn uses K = 5.
</p>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
</pre></div>
</div>
</div>

<div id="outline-container-org6129e30" class="outline-3">
<h3 id="org6129e30">Train and predict.</h3>
<div class="outline-text-3" id="text-org6129e30">
<p>
For training , we need data points(input) and labels(output).
</p>

<p>
For Moons Dataset, input is first element of the tuple.
Output is second element of the tuple.
</p>

<p>
Here is a pic of the dataset.
</p>

<p>
<img src="images/moons-dataset-graph.png" alt="nil"></p>

<div class="highlight"><pre><span></span><span class="nb">input</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

<ul class="org-ul">
<li>For training , sklearn provides <code>fit()</code> method for any estimator(model of any kind).</li>
<li>For testing , sklearn provides <code>score()</code> method for estimators , but it needs both test input and output so that it can know how well it did.</li>
<li>For predicting , sklearn provides <code>predict()</code> method for estimators, we can give any input</li>
</ul>
<div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">output</span><span class="p">)</span>
</pre></div>

<pre class="example">
KNeighborsClassifier()
</pre>


<p>
For fun we can use training data for testing.
You should not do that in real life, testing on previously trained data is like giving you question of the exam beforehand.
Model already knows the data , so you do not know whether it really learnt the data or not.
</p>

<p>
<i>But here it is for fun(Don't do it in production)</i>
</p>

<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">output</span><span class="p">))</span>
</pre></div>

<pre class="example">
1.0
</pre>


<p>
It will return a accuracy(for classification).Most probably it would be 1.0(or 100%)
</p>
</div>
</div>

<div id="outline-container-org43f06b9" class="outline-3">
<h3 id="org43f06b9">Conclusion</h3>
<div class="outline-text-3" id="text-org43f06b9">
<p>
Now that you know what the code does , try to change model's behaviour.
</p>

<p>
As it is K Nearest Neighbor , we can take any K(odd).
</p>

<p>
To change value of K in sklearn's KNN,use <code>n_neighbors</code> argument.
</p>

<div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

<p>
Try to use multiple values of K and observe the model's accuracy.Try to use even K and see what happens.
Mostly it will not change!(Try to answer why, hint:We are using training data).
</p>
</div>
</div>

<div id="outline-container-org4a0ed98" class="outline-3">
<h3 id="org4a0ed98">Departing time!</h3>
<div class="outline-text-3" id="text-org4a0ed98">
<p>
I hope you understood above explanation , if in any doubt , or have any correction regarding content.Don't hesitate to poke me in the eye!
</p>

<p>
<b>Adios!</b>
</p>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/my-cool-new-setup/" class="u-url">My cool new setup!</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                pspiagicw
            </span></p>
            <p class="dateline">
            <a href="posts/my-cool-new-setup/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-15T06:28:53+05:30" itemprop="datePublished" title="2021-05-15 06:28">2021-05-15 06:28</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-org0f551bc" class="outline-2">
<h2 id="org0f551bc">Linux is Sexy!</h2>
<div class="outline-text-2" id="text-org0f551bc">
<p>
My love for linux grows , day by day . It has the freedon that nobody can provide.
Well I don't think anybody thinks of making a car from scratch . 
Nor somebody talks how they would like to reconfigure their driving style for more productivity.
</p>

<p>
But in the Linux world this type of talk is very common.Due to a abundance of system-level packages we can customize our workflow with custom scripts,apps,etc.
</p>

<p>
I always kept a GUI handy , kept a second OS or a second account with working GUI if anything went wrong with my tiling window manager setup.
I kept my college/school things in that account , I did not mix it with my coding/fun account.
</p>

<p>
<span class="underline">Until Now</span>
</p>

<p>
The biggest problem with my previous setup was I had to switch accounts or even OS for coding or attending classes.
This time I decided to integrate both.
</p>

<p>
Now I had a choice , whether to keep a minimal setup with some GUI apps , or to keep only the required GUI apps.
I decided to go with the obvious , no GUI apps.
</p>

<p>
The only GUI app I am using is for my classes.
</p>
</div>

<div id="outline-container-org2f68432" class="outline-3">
<h3 id="org2f68432">Keyboard is priority</h3>
<div class="outline-text-3" id="text-org2f68432">
<p>
When making any setup , I make sure to remember all the keybindings,so that I can make things fast.
Well with linux , you don't have to remember keybindings, you make keybindings.
</p>

<p>
I don't think anyone in the Windows/MacOS world thinkgs in this way!Create Keybindings?
</p>

<p>
For my display manager I went with nothing, a simple <code>/etc/issue</code> file sufficed for bling.
My <code>bash_profile</code> automatically starts the window manager on login.
</p>

<p>
My window manager of choice is <i>XMonad</i> .It is fast , very customizable and is written in haskell.
My bar to go with it was <i>xmobar</i> . It provides lot of built-in widgets which makes it perfect, along with the fact that it is designed to work with xmonad.
</p>

<p>
My text editor has been emacs for the last month now and I rolled with it.Vim already spoiled me , that means I went Evil on Emacs.
If you cannot understand that reference then you must join the dark side.I will not debate Emacs V/s Vim, but can say Emacs is good.
</p>
</div>
</div>

<div id="outline-container-orgdb1bc8c" class="outline-3">
<h3 id="orgdb1bc8c">My Apps</h3>
<div class="outline-text-3" id="text-orgdb1bc8c">
<p>
My  apps include:
</p>

<ul class="org-ul">
<li>
<i><a href="https://qutebrowser.org">QuteBrowser</a></i>: Web Browser with vim keybindings.</li>
<li>
<i><a href="https://pwmt.org/projects/zathura/">Zathura</a></i>: PDF Viewer with vim keybindings</li>
<li>
<i><a href="https://feh.finalrewind.org/">feh</a></i>: Image viewer with vim keybindings.</li>
<li>
<i><a href="https://neomutt.org/">Neomutt</a></i>: Terminal Mail Client with vim keybindings.</li>
<li>
<i><a href="https://newsboat.org/">NewsBoat</a></i>: Terminal RSS feed reader with vim keybindings.</li>
<li>
<i><a href="https://github.com/dylanaraps/torque">torque</a></i>: Terminal torrent manager with vim keybindings.</li>
<li>
<i><a href="https://github.com/alacritty/alacritty">Alacritty</a></i>: My terminal of choice comes with vim keybindings.</li>
<li>
<i><a href="https://github.com/firecat53/urlscan">Urlscan</a></i>: Terminal Url Scanner and indexer with vim keybindings.</li>
</ul>
<p>
One of the common things among apps is to have vim keybindings.
</p>

<p>
It means all of them can be controlled by the keyboard and I flow through those apps without a hitch.
I even synced all the keybindings between them to allow seamless usage.
For Example pressing <code>h</code> always goes back no matter what , pressing <code>l</code> goes forward no matter what.
Pressing L on any page , opens urlscan  no matter what,independent of apps
</p>
</div>
</div>

<div id="outline-container-org31431f0" class="outline-3">
<h3 id="org31431f0">Aesthetics</h3>
<div class="outline-text-3" id="text-org31431f0">
<p>
For aesthetics I don't have much to offer.I used dracula themes from <a href="https://draculatheme.com">draculatheme.com</a> as I love it.
Other aesthetics include
</p>

<ul class="org-ul">
<li>
<i><a href="https://github.com/jonaburg/picom">Picom</a></i> (Jonaburg Fork): For animations , transparency , curved corners etc.</li>
<li>
<i><a href="https://dunst-project.org/">Dunst</a></i>: Notification Manager</li>
<li>
<i><a href="https://github.com/Airblader/unclutter-xfixes">Unclutter</a></i>: Mouse dissapear when not using.</li>
<li>
<i><a href="http://jonls.dk/redshift/">redshift</a></i>: Night light support</li>
</ul>
<p>
I think I can go on about how perfect my setup looks.
If you want to checkout my config , it's <a href="https://github.com/pspiagicw/dotfiles">here</a>.
</p>
</div>
</div>

<div id="outline-container-org1098e76" class="outline-3">
<h3 id="org1098e76">GoodBye!</h3>
<div class="outline-text-3" id="text-org1098e76">
<p>
Keep being curious , Over and Out!
</p>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/write-a-blog-they-said/" class="u-url">Write a blog they said!</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                pspiagicw
            </span></p>
            <p class="dateline">
            <a href="posts/write-a-blog-they-said/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-15T05:16:01+05:30" itemprop="datePublished" title="2021-05-15 05:16">2021-05-15 05:16</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <div id="outline-container-orgb8a317a" class="outline-2">
<h2 id="orgb8a317a">Write a blog they said</h2>
<div class="outline-text-2" id="text-orgb8a317a">
</div>
<div id="outline-container-org8812aed" class="outline-3">
<h3 id="org8812aed">Read a book!</h3>
<div class="outline-text-3" id="text-org8812aed">
<p>
I love reading technical books which are non-serious , and cater towards casual learners.It provides the most honest perspective for anyone reading.
Well the most recent one was <span class="underline">Grokking Deep Learning</span> , which provides excellent intro to the world of Deep Learning
</p>

<p>
The end of that book suggests to improve our knowledge,understanding of Deep Learning , by starting a blog about Deep Learning.
</p>

<p>
<b>Well</b> I can't deny the idea , I am very scared to execute it , a blog about Deep Learning , a topic almost anyone can understand from a few <a href="https://google.com">Google</a> Sessions.
</p>

<p>
Now that I have started a blog , this post might be the perfect session to start Deep Learning blogs.I can throw a little Machine Learning in there,
it would have a lot of coding.I have no idea how this will turn out.
</p>

<p>
If it's bad , then you might be the rare people who read it , or if it's good you might be not so alone afterall.
</p>

<p>
Anyway let's start the <a href="https://en.wikipedia.org/wiki/SpaceX_Raptor">Raptors</a>.
</p>
</div>
</div>

<div id="outline-container-org78a4917" class="outline-3">
<h3 id="org78a4917">Machine Learning</h3>
<div class="outline-text-3" id="text-org78a4917">
</div>
<div id="outline-container-orgdfecbbb" class="outline-4">
<h4 id="orgdfecbbb">Getting Started</h4>
<div class="outline-text-4" id="text-orgdfecbbb">
<p>
Well I could start with the theoretical aspects of Machine Learning , or I can start giving code , along with explanations.
</p>

<p>
I think I will go with the latter.
</p>

<p>
For getting started , we need some Packages , Python Packages.Most of Machine Learning is done in Python , it is easy , readable and has good ecosystem.
Well if you are starting with Python, you can learn it and come to this later.
</p>

<p>
Well we need to install Python Packages using <span class="underline"><a href="https://pypi.org/project/pip/">pip</a></span>. Well don't worry it comes with almost all Python installations.The packages we need are
</p>

<ol class="org-ol">
<li>Numpy: Numerical-Python, provides base for writing mathematical/scientific based code.</li>
<li>Matplotlib: Graphing tool , provides way to create complex graph and heatmaps.</li>
<li>Sklearn: Sckit-leaern , the base on which Machine Learning exists.</li>
<li>Pandas: Tool to interact with tabular data(CSV,XLSX,etc).</li>
</ol>
<p>
I am coding on a generic GNU/Linux distribution , any commands/code I write will work on all platforms  provided you have Python on your PATH variable.
For installing above packages use the <span class="underline">pip</span> command.
</p>

<div class="highlight"><pre><span></span>   pip install sklearn pandas numpy matplotlib
</pre></div>

<p>
Now that we have packages installed,let's create a new python file and begin.People wanting to use Jupyter Notebook etc, don't judge me!
</p>
</div>
</div>

<div id="outline-container-org8c0cbcd" class="outline-4">
<h4 id="org8c0cbcd">Data Collection</h4>
<div class="outline-text-4" id="text-org8c0cbcd">
<p>
We need to have data to start Machine Learning.Lucky for us <span class="underline">sklearn</span> already includes some datasets.
A dataset is a collection of tabular data along with information on source of the data.
</p>

<p>
We are going to use moons dataset , it is a simple dataset , it tries to give data about two intersecting circles(Moons!).
To use it we have to invoke <code>make_moons()</code> method from <code>sklearn.datasets</code>.
</p>

<div class="highlight"><pre><span></span>   <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_moons</span> 
   <span class="n">data</span> <span class="o">=</span> <span class="n">make_moons</span><span class="p">()</span>
</pre></div>

<p>
It returns a tuple with first field being the input data(Data we know) and second field being output data(Data we want to know about).
Here we want to predict whether the circles intersect or not, given their position.
</p>

<p>
Let's divide it into input and output variables.
</p>

<div class="highlight"><pre><span></span>   <span class="nb">input</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
   <span class="n">output</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgc85bb18" class="outline-4">
<h4 id="orgc85bb18">Training</h4>
<div class="outline-text-4" id="text-orgc85bb18">
<p>
We will use K-Nearest Neighbors algorithm, it's internal working will be explained later.The important thing , being it is used to Classify.First let's import it.
It is provided in <code>sklearn.neighbors.KNeighborsClassifier</code> .
</p>

<div class="highlight"><pre><span></span>   <span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
   <span class="n">model</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
</pre></div>
</div>
</div>

<div id="outline-container-org231e569" class="outline-4">
<h4 id="org231e569">Testing</h4>
<div class="outline-text-4" id="text-org231e569">
<p>
Using this model is easy , for training call the <span class="underline">fit</span> method and testing use the <span class="underline">score</span> method.Don't worry about why and what we are doing here!
Using the score method gives us accuracy , which will tell how good our model is. <i>Higher the Better!</i>
</p>

<p>
Tough we are not using <code>score()</code> method today , cause we don't have any testing data!!
</p>

<div class="highlight"><pre><span></span>   <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">output</span><span class="p">)</span>
</pre></div>

<pre class="example">
KNeighborsClassifier()
</pre>


<p>
But we can make predictions for ourselves, as the model is trained on the data , it can make accurate predictions , without any problem.
To make predictions we use the <code>predict</code> method.We can pass data is same way input has in an array of two numbers , which can be used which can be used to predict if they are parameters of an intersecting circle.
</p>

<div class="highlight"><pre><span></span>   <span class="n">test_input</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">2.455</span> <span class="p">,</span> <span class="mf">2.345</span> <span class="p">]]</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_input</span><span class="p">))</span>
</pre></div>

<pre class="example">
[1]
</pre>
</div>
</div>
</div>



<div id="outline-container-org86ecaf4" class="outline-3">
<h3 id="org86ecaf4">Farewell!</h3>
<div class="outline-text-3" id="text-org86ecaf4">
<p>
Let us meet again in the next post where we will learn more about Machine Learning in general.We will have a lot of fun, so don't miss it!
</p>

<p>
<span class="underline">Bye for now</span>
</p>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/a-world-full-of-ssgs/" class="u-url">A world full of SSG's</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                pspiagicw
            </span></p>
            <p class="dateline">
            <a href="posts/a-world-full-of-ssgs/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-14T15:11:24+05:30" itemprop="datePublished" title="2021-05-14 15:11">2021-05-14 15:11</time></a>
            </p>
        </div>
    </header><div class="e-content entry-content">
    <section id="blog-dilemma"><h2>Blog Dilemma</h2>
<section id="making-a-blog-is-hard"><h3>Making a blog is hard!</h3>
<p>The amount of preparation for a stable SSG system is crazy!
Well SSG stands for Static Site Generators.</p>
<p>They allow anyone to have a solid and efficient way of writing blogs.
The biggest problem being , which to choose.</p>
<p>Some are huge , some are written in other languages , some are discontinued.</p>
<p>Well right now I am using <em>Nikola</em> . It is a python based SSG which worked well enough for me.
I intend to push this to GitHub but I cannot promise it will happen!</p>
<p>Well if you are reading it , it has already happened , or has it?
Writing from this perspective , anything can happen.This post can just be a RST document in my system or this can be read by anyone acessing the internet.</p>
<p>Whatever may happen , I have already read it which means the post will die with me irrespective of the outcome.</p>
<p>Just like Neil already saw the moon. It did not matter whether NASA showed it to everyone , the sight would always be in Neil's neurons.</p>
<p>Enough talking , I have to try posting this.</p>
</section></section>
</div>
    </article>
</div>







         </main><footer id="footer"><p>Contents © 2021         <a href="mailto:pspiagicw@gmail.com">pspiagicw</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    
    

    
    
    
</body>
</html>
